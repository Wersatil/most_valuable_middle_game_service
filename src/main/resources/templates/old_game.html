<!DOCTYPE html>
<html lang="zxx">
<head>
	<title>Самый ценный мидл</title>
	<meta charset="UTF-8">
	<meta name="description" content="TheQuest Gaming Magazine Template">
	<meta name="keywords" content="gaming, html">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Favicon -->
	<link href="../static/img/favicon.ico" rel="shortcut icon"/>

	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i&display=swap" rel="stylesheet">

	<!-- Stylesheets -->
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
	<link rel="stylesheet" th:href="@{/css/font-awesome.min.css}"/>
	<link rel="stylesheet" th:href="@{/css/magnific-popup.css}"/>
	<link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}"/>
	<link rel="stylesheet" th:href="@{/css/slicknav.min.css}"/>

	<!-- Main Stylesheets -->
	<link rel="stylesheet" th:href="@{/css/style.css}"/>
</head>
<body>
	<!-- Page Preloder -->
	<div id="preloder">
		<div class="loader"></div>
	</div>

	<!-- Header section -->
	<header class="header-section">
		<a th:href="index.html">
			<img th:src="@{/img/logo.jpg}" alt="logo" style="max-height: 70px; width: auto;">
		</a>
		<div class="site-title">Самый ценный мидл</div>
		<div class="header-add">
			<img th:src="@{/img/add.jpg}" alt="">
		</div>
	</header>
	<!-- Header section end -->

	<!-- Blog section -->
	<section class="blog-section spad">
		<div class="container">
			<div class="row">
				<div class="col-lg-8">
					<div class="blog-post single-post">
						<div class="comments">
							<ul class="comments-list">
								<li>
									<img th:src="${currentPlayer.getAvatar()}" alt="">
									<div class="comment-text">
										<h6><span th:text="${currentPlayer.name}"></span></h6>
										<div class="question-text">
											<h5>
												<span th:text="${game.getQuestionId()}"></span>
												<span>. </span>
												<span th:text="${game.getQuestion()}"></span>
											</h5>
										</div>
										<div class="score-buttons">
											<a th:href = "@{/api/v2/questions/next/{player}/{game}/{scores}(player=${currentPlayer.getId()}, game=${game.getId()}, scores=3)}"><button class="scores-btn" onclick="nextQuestion(1)">1</button></a>
											<a th:href = "@{/api/v2/questions/next/{player}/{game}/{scores}(player=${currentPlayer.getId()}, game=${game.getId()}, scores=1)}"><button class="scores-btn" onclick="nextQuestion(2)">2</button></a>
											<a th:href = "@{/api/v2/questions/next/{player}/{game}/{scores}(player=${currentPlayer.getId()}, game=${game.getId()}, scores=0)}"><button class="scores-btn" onclick="nextQuestion(3)">3</button></a>
											<button class="answer-btn" onclick="showAnswer()">Ответ ИИ</button>
										</div>
									</div>
								</li>
								<li>
									<div class="comment-text">
										<p id="answer" style="display:none;"></p>
									</div>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="col-lg-4 sidebar">
					<div class="sb-widget">
						<h2 class="sb-title">Игроки</h2>
						<div class="latest-comments-widget">
							<div class="lc-item" th:each = "player : ${game.getPlayers()}">
								<img th:src="${player.getAvatar()}" alt="">
								<div class="lc-text">
									<h5><span th:text="${player.getName()}"></span></h5>
									<h6>Заслуживает ЗП: <span th:text="${player.getOfferSum()}"></span> руб</h6>
								</div>
								<a th:href = "@{/api/v2/questions/next/{player}/{game}/{scores}(player=${player.getId()}, game=${game.getId()}, scores=2)}"><button type="submit" class="scores-btn">2</button></a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- Blog section end -->

	<!-- Footer section -->
	<div class="footer-section">
		<div class="container">
			<div class="row">
				<div class="footer-widget">
					<p>1. За полный правильный ответ игрок получает 3 балла.</p>
					<p>2. За 50% ответа игрок получает 1 балл.</p>
					<p>3. Если игрок дает менее 50% ответа, он не получает баллов, и ответить на вопрос получает право один другой игрок (приоритет получают те, у кого меньше баллов). </p>
					<p>4. За полный ответ вне своей очереди игрок получает 2 балла, за неполный ответ не получает ничего.</p>
					<p></p>
				</div>
			</div>
			<div class="copyright"><p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
	<!--Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>-->
  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p></div>
		</div>
		<div class="social-links-warp">
			<div class="container">
				<div class="social-links">
					<a href="#"><i class="fa fa-instagram"></i><span>instagram</span></a>
					<a href="#"><i class="fa fa-pinterest"></i><span>pinterest</span></a>
					<a href="#"><i class="fa fa-facebook"></i><span>facebook</span></a>
					<a href="#"><i class="fa fa-twitter"></i><span>twitter</span></a>
					<a href="#"><i class="fa fa-youtube"></i><span>youtube</span></a>
					<a href="#"><i class="fa fa-tumblr-square"></i><span>tumblr</span></a>
				</div>
			</div>
		</div>
	</div>
	<!-- Footer section end -->

	<!--====== Javascripts & Jquery ======-->
	<script th:src="@{/js/jquery-3.2.1.min.js}"></script>
	<script th:src="@{/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/jquery.slicknav.js}"></script>
	<script th:src="@{/js/owl.carousel.min.js}"></script>
	<script th:src="@{/js/circle-progress.min.js}"></script>
	<script th:src="@{/js/jquery.magnific-popup.min.js}"></script>
	<script th:src="@{/js/main.js}"></script>

	<script th:inline="javascript">
		const message = /*[[${game.answer}]]*/ "";
	</script>

	<script>
		function showAnswer() {
			document.getElementById("answer").innerText = message;
			document.getElementById("answer").style.display = "block";
		}
	</script>

	<script th:inline="javascript">
		const currentPlayerId = /*[[${currentPlayer.id}]]*/ 0;
		const gameId = /*[[${game.id}]]*/ 0;
	</script>

	<script>
		async function nextQuestion(scores) {
			const response = await fetch(
					`/api/v2/questions/next/${currentPlayerId}/${gameId}/${scores}`
			);
			const game = await response.json();
			updateUI(game);
		}
	</script>
	<script>
		function updateUI(game) {
			document.getElementById("playerName").innerText = game.currentPlayer.name;
			document.getElementById("playerAvatar").src = game.currentPlayer.avatar;
			document.getElementById("questionText").innerText = game.question;
			game.players.forEach(p => {
				document.getElementById(`offer-${p.id}`).innerText = p.offerSum;
			});
		}
	</script>

	</body>
</html>

